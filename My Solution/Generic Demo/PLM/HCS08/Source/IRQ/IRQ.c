/*****************************************************************************
* IRQ implementation.
* 
* 
* Copyright (c) 2007, Freescale, Inc. All rights reserved.
*
* date     	03/23/09
* 
* No part of this document must be reproduced in any form - including copied,
* transcribed, printed or by any electronic means - without specific written
* permission from Freescale Semiconductor.
*
*****************************************************************************/

#include "IRQ_Interface.h"
/************************************************************************************
*************************************************************************************
* Private prototypes
*************************************************************************************
************************************************************************************/

/************************************************************************************
*************************************************************************************
* Private type definitions
*************************************************************************************
************************************************************************************/

/************************************************************************************
*************************************************************************************
* Private memory declarations
*************************************************************************************
************************************************************************************/

static irqCallback_t IrqCallBack;

/************************************************************************************
*************************************************************************************
* Private macros
*************************************************************************************
************************************************************************************/

/************************************************************************************
*************************************************************************************
* Interface functions
*************************************************************************************
************************************************************************************/
void IRQ_Init
(
irqCallback_t UserCallBack
)
{
   IRQ_AckIrq(); 			  	/* Clear Interrupt Flag   */
   IRQ_InitIrq(); 			  /* Inits control register */
   IrqCallBack = UserCallBack;  /*Sets the IRQ calback*/
}


/************************************************************************************
*************************************************************************************
* private functions
*************************************************************************************
************************************************************************************/
/* Place it in NON_BANKED memory */
#pragma CODE_SEG ISR_SEGMENT
/************************************************************************************/
INTERRUPT_KEYWORD void IRQ_Isr(void)
{
  IRQ_AckIrq(); 			                   	/* Clear Interrupt Flag   */
  if(NULL != IrqCallBack){
    IrqCallBack();       /*Calls the callback*/  
  }
}

/************************************************************************************/
INTERRUPT_KEYWORD void Default_Dummy_ISR(void)
{
   // Unimplemented ISRs trap.
   asm BGND;
}
#pragma CODE_SEG DEFAULT
